var initNav=function(){$(".side-category .sub-item").mouseenter(function(){$(this).find(".left-sub-list").show().find("img").trigger("porty")}).mouseleave(function(){$(this).find(".left-sub-list").hide()}),$(".side-category img").lazyload({effect:"fadeIn",event:"porty"})},initElevator=function(){var e=[],t=$(".elevator_list li");for(var n=0;n<t.length;n++){var r=$("#"+t.eq(n).attr("data-id")).offset();r&&e.push(r.top-100)}$(".elevator_box").on("click",".elevator_list li",function(e){e.preventDefault();var t=$("#"+$(this).attr("data-id"));t&&t.offset()&&$("body,html").animate({scrollTop:t.offset().top},200),$(this).addClass("show").siblings().removeClass("show")});var i;$(window).scroll(function(n){i=n.timeStamp,setTimeout(function(){if(i==n.timeStamp){$(window).scrollTop()>=600?$(".elevator_box").addClass("elevator_box_show"):$(".elevator_box").removeClass("elevator_box_show");var r=$(window).scrollTop();if(r>e[e.length-1]){t.eq(e.length-1).addClass("show").siblings().removeClass("show");return}for(var s=0;s<e.length-1;s++)r>e[s]&&r<e[s+1]&&t.eq(s).addClass("show").siblings().removeClass("show")}},200)})},indexSlide=function(){this.eleBox,this.eleList,this.elePoints,this.playLock=!1,this.playDuration=500,this.index=0,this.eleLength,this.playDwell=5e3};indexSlide.prototype.play=function(){var e=this;this.autoPlayInterval=setInterval(function(){e.next()},e.playDwell)},indexSlide.prototype.go=function(e){var t=this,n=t.eleList.children().eq(e);t.updateBanner(n),n.fadeIn(t.playDuration),t.eleList.children().not(n).fadeOut(t.playDuration,function(){t.playLock=!1}),t.updatePoint(e)},indexSlide.prototype.next=function(){if(this.playLock)return;this.playLock=!0,this.index=(this.index+1)%this.eleLength,this.go(this.index)},indexSlide.prototype.prev=function(){if(this.playLock)return;this.playLock=!0,this.index=(this.index-1+this.eleLength)%this.eleLength,this.go(this.index)},indexSlide.prototype.showBtnAndbind=function(){var e=this;e.eleBox.find(".slide-next").show().click(function(){e.next()}),e.eleBox.find(".slide-prev").show().click(function(){e.prev()}),e.eleBox.mouseenter(function(){clearInterval(e.autoPlayInterval)}).mouseleave(function(){e.play()}),e.elePoints.on("click","a",function(t){e.go($(this).index())})},indexSlide.prototype.showPoint=function(e){var t=[];for(var n=0;n<this.eleLength;n++)t[n]='<a href="javascript:;" onclick="return false;"></a>';this.elePoints.html(t.join("")).show(),this.elePoints.css("position")=="absolute"&&(e|=0,this.elePoints.css("marginLeft",(e-this.elePoints.outerWidth())/2)),this.updatePoint(0)},indexSlide.prototype.updatePoint=function(e){this.elePoints.find("a").removeClass("curr-point").eq(e).addClass("curr-point")},indexSlide.prototype.updateBanner=function(e){function t(e){return e=e.replace("qhimg","qhmsg"),e.indexOf("qhmsg")==-1?e:window.isSupportWebp?e.replace(".jpg",".webp"):e}e=e?$(e):this.eleList.find(".slider-film").eq(0);try{e.filter(".js-lazyload").trigger("porty"),e.find(".js-lazyload").trigger("porty")}catch(n){if(e&&e.find("img")){var r=e.find("img");r.each(function(){var e=$(this);e.data("original")&&e.attr("src",t(e.data("original"))).removeAttr("data-original")})}e&&e.filter(".js-lazyload").length>0&&e.data("original")&&e.css({backgroundImage:"url("+t(e.data("original"))+")"}).removeAttr("data-original")}},indexSlide.prototype.init=function(e,t,n){this.eleBox=$(e),this.playDwell=t||this.playDwell,this.eleList=this.eleBox.find(".slideBox"),this.eleLength=this.eleList.find(".slider-film").length,this.elePoints=this.eleBox.find(".slide-point"),this.updateBanner(),this.eleList.children().first().show(),this.eleLength>1?(this.showPoint(n),this.showBtnAndbind(),this.play()):this.eleBox.find(".slide-next,.slide-prev").hide(),this.eleList.find(".js-lazyload").lazyload({event:"porty"})};var countdown=function(e){var t=$(".countdown"),n=0,r=function(){},i=function(e,t){e.html(t.day+"\u5929"+t.hour+"\u65f6"+t.minute+"\u5206"+t.second+"\u79d2"+t.msecond)},s=+(new Date),o=!1,u=function(e){var s=e||{};t=$(s.eleRemain),t&&(n=parseInt(t.attr("data-countdown"))),i=s.update||i,r=s.callback,o=s.msPrecision,n>0&&f()},a=function(e){var n={msecond:Math.floor(e%1e3/10),second:Math.floor(e/1e3)%60,minute:Math.floor(e/1e3/60%60),hour:Math.floor(e/1e3/60/60%24),day:Math.floor(e/1e3/60/60/24)};typeof i=="function"&&i(t,n)},f=function(){var e=n*1e3+s-new Date;e>0?(a(e),setTimeout(f,o?30:300)):typeof r=="function"&&r(t)};u(e)},initCountdown=function(){$(".countdown").each(function(e,t){new countdown({eleRemain:$(t),update:function(e,t){e.parent().show(),e.html((t.day>0?"<i>"+t.day+"</i>\u5929":"")+"<i>"+t.hour+"</i>\u65f6<i>"+t.minute+"</i>\u5206<i>"+t.second+"</i>\u79d2")},callback:function(e){e.parent().hide()}})})},newProducts=function(){var e="notinit",t=$(".showmore"),n=t.data("url")||location.protocol+"//search.mall.360.com/search/latest?q=*",r=$(".part-newproducts .new-list"),i=function(){if(t.data("running"))return;t.data("running",!0);var e=t.data("page")||0,i=100;$.ajax({url:n,dataType:"jsonp",data:{page:e,size:i}}).then(function(n){t.data("running",!1);if(n.errno==0&&n.data){var s=n.data;s.list&&$.each(s.list,function(e,t){var n=[];n.push('<li><a href="http://alalei.com/home/good/detail/'+t.id+'" target="_blank" data-monitor="home_new_goodsclick'+(e+1)+'"><dl class="new-item">'),n.push('<dt><img class="js-lazyload" src="http://alalei.com/'+t.picture+'"></dt>'),n.push('<dd class="title">'+t.good+"</dd>"),n.push('<dd class="price"><span><i class="yen">\uffe5</i>'+t.price+"</span> "+t.time+"</dd>"),n.push("</dl></a></li>"),r.append(n.join(""))}),$(".js-lazyload").lazyload(),e++,t.data("page",e);if(e*i>=s.total){t.hide(),$(".nomore").show();return}}},function(e){t.data("running",!1),console&&console.error(e)})},s=function(){e==="notinit"&&(e="inited",$("body").on("click",".showmore",function(e){i()}),i())};return{init:s}},indexPage=function(){var e=function(){initNav(),initElevator(),(new indexSlide).init(".banner-slide",5e3,10),$(".js-lazyload").lazyload({threshold:50}),setTimeout(function(){$(".part-suggest").each(function(e,t){(new indexSlide).init(t,5e3)})},1e3),initCountdown();var e=function(){$(window).scrollTop()>=$(".part-newproducts").offset().top-$(window).height()-200&&(newProducts().init(),$(window).off("scroll",e))};$(window).on("scroll",e)};return{init:e}}();void function(){var e=function(){var t=$(window).height()/2,n=-($(".popping img").width()/2),r=-($(".popping img").height()/2);if(n==-0){setTimeout(e,200);return}$(".popping").css("top",t),$(".popping").css("margin-left",n+"px"),$(".popping").css("margin-top",r+"px")}}();