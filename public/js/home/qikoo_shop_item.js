var shopItem=function(){var e={cartTip:function(e){var t=['<div class="dialog-addtocart">','<div class="dialog-bar">',"\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66",'<a href="#" onclick="return false;" class="dialog-close" title="\u5173\u95ed"></a>',"</div>",'<div class="dialog-content">','<p><span class="ico"></span>\u5546\u54c1\u5df2\u6210\u529f\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66</p>','<div class="dialog-console">','<a class="console-btn-continue" href="#" onclick="return false;" title="\u7ee7\u7eed\u8d2d\u7269">\u7ee7\u7eed\u8d2d\u7269</a>','<a class="console-btn-gocart" href="#" onclick="return false;" title="\u53bb\u8d2d\u7269\u8f66\u7ed3\u7b97">\u53bb\u8d2d\u7269\u8f66\u7ed3\u7b97<span></span></a>',"</div>","</div>","</div>"].join(""),n=$(t).appendTo("body"),r=n.filter(".dialog-addtocart"),i=($(window).width()-368)/2,s=$(window).scrollTop()+200;r.css("left",i),r.css("top",s),n.filter(".dialog-bg").css("height",$(document).height()),n.find("a.console-btn-continue,a.dialog-close").click(function(){window.location.reload()}),n.find("a.console-btn-gocart").click(function(){location.href="/shop/shopcart"})},warTip:function(e){$(".mask").show();var t=['<div class="dialog-war">','<div class="dialog-bar">',"\u63d0\u793a",'<a href="#" onclick="return false;" class="dialog-close" title="\u5173\u95ed"></a>',"</div>",'<div class="dialog-content">',"<p>"+e+"</p>",'<div class="dialog-console">','<a class="console-btn-confirm" href="#" onclick="return false;" title="\u786e\u5b9a">\u786e\u5b9a</a>',"</div>","</div>","</div>"].join(""),n=$(t).appendTo("body"),r=n.filter(".dialog-war"),i=($(window).width()-r.width())/2;r.css("left",i),r.css("top","200px"),n.filter(".dialog-bg").css("height",$(document).height()),n.find("a.dialog-close,a.console-btn-confirm").click(function(){$(".dialog-war").remove(),$(".mask").hide()})}},t=function(){var e=$(".c .gTab").offset().top+100,t,n=$("#gInfoBar .links a").filter(function(e,t){return $(t).attr("href").substr(0,1)==="#"}).map(function(e,t){return $(".c a[name='gInfo']")});$(window).scroll(function(){var r=$(document).scrollTop();r<e&&$("#gInfoBar").css({top:"-70px"}),clearTimeout(t),t=setTimeout(function(){r>e?$("#gInfoBar").animate({top:"0"},300):$("#gInfoBar").animate({top:"-70px"},300)},500);var i=$.map(n,function(e){var t=parseInt(e.css("margin"),10),n=parseInt(e.css("top"),10);return t=isNaN(t)?0:t,n=isNaN(n)?0:n,e.offset().top+t+n});if(top[0]>r)return;var s=$("#gInfoBar .links a.cur").index();for(var o=0;o<i.length-1;++o)if(i[o]<r&&i[o+1]>=r){$("#gInfoBar .links a").removeClass("cur"),$("#gInfoBar .links a").eq(o).addClass("cur");return}$("#gInfoBar .links a").removeClass("cur"),$("#gInfoBar .links a").eq(i.length-1).addClass("cur")}),$("#glist").delegate("li","click",function(e){if($(this).attr("class")=="cur")return!1})},n=function(){var e=$(".gift").data("itemid"),t={};t[e]=1,$.get("/shop/getbuyfreeinfo",{itemid:JSON.stringify(t)},function(e){e&&e.errno==0&&e.data&&$.each(e.data,function(e,t){var n=t.buyfree,r=['<ul class="gift-list gift-collapse">'];$.each(n,function(e,t){if(t.data[0]){var n=t.data[0];r.push('<li><a class="gift-name" href="/shop/item?item_id='+n.item_id+'" target="_blank">\u9001'),r.push(n.iteminfo.title),r.push("</a>"),r.push('<i class="gift-count">'),n.count>n.item_amount?r.push("\uff08\u5df2\u552e\u5b8c\uff09"):r.push("x"+n.item_num),r.push("</i></li>")}}),r.push("</ul>"),$(".gift").append(r.join("")),$(".gift-list li").length>1&&($(".gift").append('<i class="gift-arrow gift-arrowup"></i>'),$(".gift-arrow").on("click",function(){if($(".gift-arrowdown")&&$(".gift-arrowdown").length>0){var e=$(".gift-arrowdown");e.addClass("gift-arrowup").removeClass("gift-arrowdown"),e.addClass("gift-arrowup").removeClass("gift-arrowdown");var t=$(".gift-list"),n=t.height(),r=t.css("height","auto").height();t.height(n).animate({height:r})}else if($(".gift-arrowup")&&$(".gift-arrowup").length>0){var e=$(".gift-arrowup");e.addClass("gift-arrowdown").removeClass("gift-arrowup"),e.addClass("gift-arrowdown").removeClass("gift-arrowup"),$(".gift-list").animate({height:"28px"})}})),$(".gift").show()})},"json")},r=function(e){},i=function(e){t(),n(),r(e)};return{init:i,cartTip:e.cartTip,warTip:e.warTip}}();$(function(){$(".consult").find("dd i").remove(),$(".consult").find("dd").prepend($("<i></i>"))}),$(function(){if(window.template==undefined)return;if($(".dp_prd_wrap").length<1)return;$(".dp_prd_wrap").width($(".dp_prd").length*215+5),$(".dp_prd").length>4&&$(".scroll_wrap").width(660),$.getJSON("/shop/getChoiedList",{item_id:qikoo.getUrlParam("item_id")},function(e){var t=[];$.each(e.data,function(e,n){$.each(n.childs,function(e,n){t.push(n)})}),t.length>0&&$(".dp_wrap,.dp_wrap_title").show(),$(".dp_prd_wrap").html(template("tpl_dapei",{list:t})),setTimeout(function(){$(".dp_prd_wrap").width($(".dp_prd").length*210+5),$(".dp_prd").length>4&&($(".scroll_wrap").width(640),$(".scroll_wrap").css({"overflow-x":"scroll"}))}),$(".dp_wrap_pimg_ori img").attr("src",$(".scroll-items img").eq(0).attr("src"))}),function(){var e=[];$("body").on("click",".dp_prd_wrap",function(){e=[];var t=0;$(this).find("input[type=checkbox]:checked").each(function(){e.push($(this).data("item")),t+=parseFloat($(this).data("price"))}),$(".dq_price span").html("\uffe5"+(prd.price+t)),$(".dp_num").html("\u5df2\u9009\u62e9"+$(this).find("input[type=checkbox]:checked").length+"\u4e2a\u914d\u4ef6")}),$("body").on("click",".dq_addcart",function(){var t=this;QHPass.when.signIn(function(){$(t).data("running")!=1&&$(t).data("running",!0),$.getJSON("/shop/addtocartMulti",{item_id:qikoo.getUrlParam("item_id"),num:$(".goodsCount").val(),ids:e},function(e){$(t).data("running",!0),0==e.errno?location.href="/shop/shopcart":qikoo.dialog.alert(e.errmsg)})})})}()}),$(function(){var e=function(){$(".picbox").delegate(".tinypic","mouseenter",function(){return $(".picbox .tinypic").removeClass("cur"),$(".bigImg img").attr("src",$(this).find("img").attr("src")),$(this).addClass("cur"),!1});var e=function(){return parseInt($(".pic-selector .scroll .scroll-items").css("left"),10)},t=106,n=function(){var n=e();n==0?$(".picbox .pic-selector .left").addClass("leftdisabled"):$(".picbox .pic-selector .left").removeClass("leftdisabled");var r=$(".picbox .pic-selector .tinypic").length;n<=(r-5)*t*-1?$(".picbox .pic-selector .right").addClass("rightdisabled"):$(".picbox .pic-selector .right").removeClass("rightdisabled")};$(".picbox .pic-selector .right").click(function(){if($(this).hasClass("rightdisabled")||$(this).hasClass("locked"))return!1;var r=this;$(r).addClass("locked");var i=e();$(".pic-selector .scroll .scroll-items").animate({left:i-t+"px"},"fast",function(){$(r).removeClass("locked"),n()})}),$(".picbox .pic-selector .left").click(function(){if($(this).hasClass("leftdisabled")||$(this).hasClass("locked"))return!1;var r=this;$(r).addClass("locked");var i=e();$(".pic-selector .scroll .scroll-items").animate({left:i+t+"px"},"fast",function(){$(r).removeClass("locked"),n()})}),n()},t=function(){function e(e){$(".bigImg img").attr("src",e)}function t(e){$("#winSelector").css("display")=="none"&&$("#winSelector,#zoomView").show(),$("#winSelector").css(f(e)),e.stopPropagation()}function n(e){$("#winSelector").css("display")!="none"&&$("#winSelector,#zoomView").hide(),e.stopPropagation()}function a(){$("#zoomView img").attr("src",$(".bigImg img").attr("src"))}function f(e){if(e==null)return;var t=$(".bigImg img").offset().left,n=$(".bigImg img").offset().top;X=e.pageX-t-r/2,Y=e.pageY-n-i/2,X=X<0?0:X,Y=Y<0?0:Y,X=X+r>s?s-r:X,Y=Y+i>o?o-i:Y;if(u==null){u=960,$viewImgHeight=960;if(u<200||$viewImgHeight<200)u=$viewImgHeight=960;$height=i*$viewImgHeight/o,$("#zoomView").width(r*u/s),$("#zoomView").height($height)}var a=X*u/s,f=Y*$viewImgHeight/o;return $("#zoomView img").css({left:a*-1,top:f*-1}),$("#zoomView").css({top:$(".bigImg").offset().top,left:$(".bigImg").offset().left+$(".bigImg").width()+15}),{left:X-1,top:Y-1}}$(".bigImg img").load(function(){a()}),$(".bigImg img").mouseover(t),$(".bigImg img,#winSelector").mousemove(t).mouseout(n);var r=$("#winSelector").width(),i=$("#winSelector").height(),s=$(".bigImg img").width(),o=$(".bigImg img").height(),u=$viewImgHeight=$height=null;a(),$("#zoomView").scrollLeft(0).scrollTop(0)};e()}),$(function(){if($(".handbuy").length>0)if(remain==-1)$(".handbuy").hide();else{var e=parseInt(remain/86400);hour=parseInt((remain-e*86400)/3600),min=parseInt((remain-e*86400-hour*3600)/60),sec=parseInt(remain%60),secString=hourString=minString=dayString="";var t=setInterval(function(){sec--,sec==-1&&(min>0?(min--,sec=59):min==0&&(hour>0?(hour--,min=59,sec=59):hour==0&&e>0&&(e--,hour=23,min=59,sec=59))),sec<10?secString="0"+sec:secString=sec.toString(),min<10?minString="0"+min:minString=min.toString(),hour<10?hourString="0"+hour:hourString=hour.toString(),e<10?dayString="0"+e:dayString=e.toString(),$(".day1").html(dayString.substring(0,1)),$(".day2").html(dayString.substring(1,2)),$(".hour1").html(hourString.substring(0,1)),$(".hour2").html(hourString.substring(1,2)),$(".min1").html(minString.substring(0,1)),$(".min2").html(minString.substring(1,2)),$(".sec1").html(secString.substring(0,1)),$(".sec2").html(secString.substring(1,2)),e==0&&hour==0&&min==0&&sec==0?(clearInterval(t),$("#itemshow").hide()):$("#itemshow").show()},1e3)}}());